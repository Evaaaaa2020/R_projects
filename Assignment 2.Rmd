---
title: "Assignment 2"
output:
  html_document:
    df_print: paged
---
#Q1:Load Data and Draw a scatter plot
```{r,echo=TRUE,fig.height=5, fig.width=10,message=TRUE}
library(ggplot2)
#load data
mydata = readRDS("./vitcap.rds")

#plot the scatter plot
gg_scatterplot = ggplot(mydata, aes(x=age, y=vital.capacity)) +
  geom_point(aes(color=group))
gg_scatterplot

```
#Q2: Build a simple linear regression model and plot
```{r,echo=TRUE,fig.height=5, fig.width=10,message=TRUE}
#build a regression model
fit = lm(mydata$vital.capacity ~ mydata$age)
summary(fit)

#plot confidence interval
gg_scatterplot + geom_smooth(method="lm", fullrange=TRUE, size=.5, n=1000)

```

#Q3: Perform model checking
```{r,echo=TRUE,fig.height=10, fig.width=20,message=TRUE}
par(mfrow=c(2,2))
plot(fit)
shapiro.test(fit$residuals)
```
Conclusion: 

1) From the shape of residual plot, the points are slightly distributed above the line of residuals = 0. This indicates that the model could have a non-linearity problem.

2) From the shape of residuals' QQ-plot, residuals are a relatively even-distributed, which is a signal of normal distribution. Followed, a Shapiro-Wilk normality test (p = 0.8329) confirms such observation (i.e., a normal distribution).

In all, the model checking suggests a non-linearity problem. 

